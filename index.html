<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ±äº¬è¶Šå¾Œæ¹¯æ¾¤è¡Œç¨‹</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { background-color: #0f172a; margin: 0; overscroll-behavior-y: contain; text-align: left; }
        * { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        const { motion, AnimatePresence } = FramerMotion;
        
        const { 
            Plane, ShoppingBag, Snowflake, Star, Train, CheckCircle2, Circle, 
            Calendar, ChevronRight, X, Info, Navigation, Trash2, CloudSnow, 
            CloudSun, ExternalLink, MapPin, Hotel, ShieldAlert, AlertTriangle, MessageCircle, ShoppingCart 
        } = lucide;

        const itineraryData = [
            { 
                day: "Day 1", date: "2/1", title: "å•Ÿç¨‹èˆ‡æ·±å¤œæ±äº¬", icon: <Plane />, category: ["transport"],
                color: "from-blue-600 to-indigo-700",
                bgUrl: "https://images.unsplash.com/photo-1542259009477-d625c009b5d7?q=80&w=2070&auto=format&fit=crop", 
                detail: "èˆªç­ MM860 | æŠµé”ç¾½ç”°", 
                mapQuery: "Ostay Ueno Tokyo",
                flightInfo: { no: "Peach MM860", route: "TPE âœˆï¸ HND", terminal: "æ¡ƒåœ’ T1 / ç¾½ç”° T3" },
                extendedDetail: [
                    { time: "20:55", task: "èˆªç­èµ·é£›å‰å¾€ç¾½ç”°" },
                    { time: "00:50", task: "æŠµé”ç¾½ç”°æ©Ÿå ´ T3" },
                    { time: "02:15", task: "æŠµé” Ostay Ueno å…¥ä½" }
                ],
                memo: "å…¬å¯“ä¸‹æœ‰ 24H è¶…å¸‚ã€‚"
            },
            { 
                day: "Day 2", date: "2/2", title: "é›ªå…·å°ˆé …ï¼šåŸå¸‚è³¼ç‰©", icon: <ShoppingBag />, category: ["shopping"],
                color: "from-purple-500 to-pink-500",
                bgUrl: "https://images.unsplash.com/photo-1503899036084-c55cdd92da26?q=80&w=2070&auto=format&fit=crop", 
                detail: "ç¥ç”°é›ªå…·è¡— | æ¼«æ­¥ä¸Šé‡", 
                mapQuery: "ç¥ç”°å°å·ç”ºé›ªå…·è¡—",
                extendedDetail: [
                    { time: "11:00", task: "èµ·åºŠè£œçœ  & æ—©åˆé¤" },
                    { time: "13:00", task: "ç¥ç”°å°å·ç”ºé›ªå…·è¡—æ¡è²·" }
                ],
                memo: "Suica ç¶å®š Apple Wallet æ‰‹æ©Ÿé€²å‡ºæ›´æ–¹ä¾¿ã€‚"
            },
            { 
                day: "Day 3", date: "2/3", title: "å¤¢å¹»è¿ªå£«å°¼æµ·æ´‹", icon: <Star />, category: ["attraction"],
                color: "from-amber-400 to-orange-500",
                bgUrl: "https://images.unsplash.com/photo-1594916309831-294025b42d76?q=80&w=2070&auto=format&fit=crop", 
                detail: "DisneySea æ”»ç•¥ | DPA æ¶åˆ¸", 
                mapQuery: "Tokyo DisneySea",
                extendedDetail: [
                    { time: "07:30", task: "åŒ…è»Šé£¯åº—é–€å£é›†åˆ" },
                    { time: "08:30", task: "APP æ¶é ˜ DPA é ç´„" }
                ],
                memo: "å¿…æ¶é …ç›®ï¼šå¤¢å¹»æ³‰é„‰ã€‚"
            }
        ];

        const initialPackingList = {
            "ğŸ“‹ è¡Œå‰ä½œæ¥­": ["æ©Ÿç¥¨/é£¯åº—", "æ—…éŠä¿éšª", "Esim", "VJW"],
            "ğŸ” éš¨èº«è­‰ä»¶": ["è­·ç…§", "èº«åˆ†è­‰", "æ—¥å¹£ç¾é‡‘"]
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('itinerary');
            const [checkedItems, setCheckedItems] = useState({});
            const [selectedDay, setSelectedDay] = useState(null);
            const [filter, setFilter] = useState('all');
            const [countdown, setCountdown] = useState("");
            const [currentBg, setCurrentBg] = useState(itineraryData[0].bgUrl);

            useEffect(() => {
                const target = new Date("2026-02-01T20:55:00").getTime();
                const interval = setInterval(() => {
                    const now = new Date().getTime();
                    const diff = target - now;
                    if (diff < 0) {
                        setCountdown("å·²å•Ÿç¨‹");
                        clearInterval(interval);
                    } else {
                        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                        setCountdown(`${d}å¤©`);
                    }
                }, 1000);
                return () => clearInterval(interval);
            }, []);

            const filteredItinerary = useMemo(() => {
                if (filter === 'all') return itineraryData;
                return itineraryData.filter(item => item.category.includes(filter));
            }, [filter]);

            return (
                <div className="min-h-screen text-white overflow-x-hidden pb-24 relative">
                    <div className="fixed inset-0 z-0">
                        <AnimatePresence mode='wait'>
                            <motion.img
                                key={currentBg}
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 0.3 }}
                                exit={{ opacity: 0 }}
                                src={currentBg}
                                className="w-full h-full object-cover"
                            />
                        </AnimatePresence>
                        <div className="absolute inset-0 bg-gradient-to-b from-slate-900/20 to-slate-900 z-10" />
                    </div>

                    <header className="relative z-30 px-6 pt-12 pb-6">
                        <div className="flex justify-end mb-4">
                            <button onClick={() => window.open('https://www.data.jma.go.jp/multi/yoho/yoho_detail.html?code=130010&lang=cn_zt')} className="bg-white/10 p-2 rounded-xl text-xs flex items-center gap-2">
                                <CloudSun size={16} /> å¤©æ°£æŸ¥è©¢
                            </button>
                        </div>
                        <h1 className="text-3xl font-black">{countdown} å¾Œå•Ÿç¨‹</h1>
                    </header>

                    <nav className="sticky top-4 z-50 px-4 mb-8">
                        <div className="bg-slate-900/80 backdrop-blur-xl p-1 rounded-full border border-white/10 flex">
                            {['itinerary', 'packing'].map((tab) => (
                                <button key={tab} onClick={() => setActiveTab(tab)} className={`flex-1 py-3 rounded-full text-xs font-bold uppercase relative ${activeTab === tab ? 'text-white' : 'text-slate-500'}`}>
                                    {activeTab === tab && <motion.div layoutId="tab" className="absolute inset-0 bg-cyan-600 rounded-full z-0" />}
                                    <span className="relative z-10">{tab === 'itinerary' ? 'è¡Œç¨‹' : 'è¡Œæ'}</span>
                                </button>
                            ))}
                        </div>
                    </nav>

                    <main className="relative z-30 px-6">
                        {activeTab === 'itinerary' && (
                            <div className="space-y-4">
                                {filteredItinerary.map((item) => (
                                    <div key={item.day} onClick={() => {setSelectedDay(item); setCurrentBg(item.bgUrl)}} className="bg-white rounded-2xl p-4 flex items-center gap-4">
                                        <div className={`w-12 h-12 rounded-xl bg-gradient-to-br ${item.color} flex items-center justify-center text-white`}>
                                            {item.icon}
                                        </div>
                                        <div className="flex-1">
                                            <div className="text-slate-900 font-bold">{item.title}</div>
                                            <div className="text-slate-400 text-xs">{item.detail}</div>
                                        </div>
                                        <ChevronRight size={16} className="text-slate-300" />
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'packing' && (
                            <div className="space-y-6">
                                {Object.entries(initialPackingList).map(([category, items]) => (
                                    <div key={category} className="bg-slate-800/50 p-5 rounded-2xl">
                                        <h3 className="text-cyan-400 text-xs font-bold mb-4">{category}</h3>
                                        <div className="space-y-3">
                                            {items.map(item => (
                                                <div key={item} onClick={() => setCheckedItems(prev => ({...prev, [item]: !prev[item]}))} className="flex items-center gap-3">
                                                    {checkedItems[item] ? <CheckCircle2 size={18} className="text-emerald-500" /> : <Circle size={18} className="text-slate-600" />}
                                                    <span className={`text-sm ${checkedItems[item] ? 'line-through text-slate-500' : ''}`}>{item}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>

                    <AnimatePresence>
                        {selectedDay && (
                            <div className="fixed inset-0 z-[100] flex items-end">
                                <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} onClick={() => setSelectedDay(null)} className="absolute inset-0 bg-black/80" />
                                <motion.div initial={{ y: "100%" }} animate={{ y: 0 }} exit={{ y: "100%" }} className="relative w-full bg-white rounded-t-3xl p-6 text-slate-900 max-h-[80vh] overflow-y-auto">
                                    <h2 className="text-2xl font-black mb-6">{selectedDay.title}</h2>
                                    <div className="space-y-6">
                                        {selectedDay.extendedDetail.map((step, i) => (
                                            <div key={i} className="flex gap-4 border-l-2 border-slate-100 pl-4">
                                                <div className="text-cyan-600 font-bold text-xs">{step.time}</div>
                                                <div className="font-bold">{step.task}</div>
                                            </div>
                                        ))}
                                    </div>
                                    <button onClick={() => window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(selectedDay.mapQuery)}`)} className="w-full bg-slate-900 text-white py-4 rounded-xl font-bold mt-8">é–‹å•Ÿåœ°åœ–</button>
                                </motion.div>
                            </div>
                        )}
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
